import{H as e,a as t,t as r,c as i,b as n,d as f,r as a,e as s,f as c,g as o}from"./vendor-rgb-CjW5GTuo.js";import{b as d}from"./vendor-nostr-CaLlG00n.js";class u extends e{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,t(e);const f=r(n);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const a=this.blockLen,s=new Uint8Array(a);s.set(f.length>a?e.create().update(f).digest():f);for(let t=0;t<s.length;t++)s[t]^=54;this.iHash.update(s),this.oHash=e.create();for(let t=0;t<s.length;t++)s[t]^=106;this.oHash.update(s),i(s)}update(e){return n(this),this.iHash.update(e),this}digestInto(e){n(this),f(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:i,destroyed:n,blockLen:f,outputLen:a}=this;return e.finished=i,e.destroyed=n,e.blockLen=f,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const b=(e,t,r)=>new u(e,t).update(r).digest();function h(e,t){return b(c,e,t)}b.create=(e,t)=>new u(e,t);const p="0123456789abcdefABCDEF";p.split("").map(e=>e.codePointAt(0));const l=Array(256).fill(!0).map((e,t)=>{const r=String.fromCodePoint(t),i=p.indexOf(r);return i<0?void 0:i<16?i:i-6}),y=new TextEncoder;function v(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;++i)if(e[i]!==t[i])return e[i]<t[i]?-1:1;return e.length===t.length?0:e.length>t.length?1:-1}function g(e,t,r){if(t+1>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r>255)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 255. Received ${r}`);e[t]=r}function w(e,t,r,i){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(i=i.toUpperCase(),r>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 4294967295. Received ${r}`);"LE"===i?(e[t]=255&r,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r)}function m(e,t,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if("LE"===(r=r.toUpperCase())){let r=0;return r=(r<<8)+e[t+3]>>>0,r=(r<<8)+e[t+2]>>>0,r=(r<<8)+e[t+1]>>>0,r=(r<<8)+e[t]>>>0,r}{let r=0;return r=(r<<8)+e[t]>>>0,r=(r<<8)+e[t+1]>>>0,r=(r<<8)+e[t+2]>>>0,r=(r<<8)+e[t+3]>>>0,r}}new TextDecoder;const E=e=>function(e){const t=y.encode(e||""),r=new Uint8Array(Math.floor(t.length/2));let i;for(i=0;i<r.length;i++){const e=l[t[2*i]],n=l[t[2*i+1]];if(void 0===e||void 0===n)break;r[i]=e<<4|n}return i===r.length?r:r.slice(0,i)}(e);function _(e){if(!e)throw new Error("ecc library invalid")}function k(e){const t=typeof e;return"string"===t?`"${e}"`:"number"===t||"bigint"===t||"boolean"===t?`${e}`:"object"===t||"function"===t?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function P(e,t,r,i,n){const f=n&&"input"in n?n.input:r.value,a=n?.expected??e.expects??null,s=n?.received??k(f),c={kind:e.kind,type:e.type,input:f,expected:a,received:s,message:`Invalid ${t}: ${a?`Expected ${a} but r`:"R"}eceived ${s}`,requirement:e.requirement,path:n?.path,issues:n?.issues,lang:i.lang,abortEarly:i.abortEarly,abortPipeEarly:i.abortPipeEarly},o="schema"===e.kind,d=n?.message??e.message??(e.reference,void c.lang)??(o?void c.lang:null)??i.message??void c.lang;d&&(c.message="function"==typeof d?d(c):d),o&&(r.typed=!1),r.issues?r.issues.push(c):r.issues=[c]}var x=class extends Error{issues;constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function K(e){return{kind:"validation",type:"integer",reference:K,async:!1,expects:null,requirement:Number.isInteger,message:e,_run(e,t){return e.typed&&!this.requirement(e.value)&&P(this,"integer",e,t),e}}}function T(e,t){return{kind:"validation",type:"length",reference:T,async:!1,expects:`${e}`,requirement:e,message:t,_run(e,t){return e.typed&&e.value.length!==this.requirement&&P(this,"length",e,t,{received:`${e.value.length}`}),e}}}function A(e,t){return{kind:"validation",type:"max_value",reference:A,async:!1,expects:`<=${e instanceof Date?e.toJSON():k(e)}`,requirement:e,message:t,_run(e,t){return e.typed&&e.value>this.requirement&&P(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():k(e.value)}),e}}}function I(e,t){return{kind:"validation",type:"min_value",reference:I,async:!1,expects:`>=${e instanceof Date?e.toJSON():k(e)}`,requirement:e,message:t,_run(e,t){return e.typed&&e.value<this.requirement&&P(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():k(e.value)}),e}}}function N(e,t){return{kind:"schema",type:"instance",reference:N,expects:e.name,async:!1,class:e,message:t,_run(e,t){return e.value instanceof this.class?e.typed=!0:P(this,"type",e,t),e}}}function H(e){return{kind:"schema",type:"number",reference:H,expects:"number",async:!1,message:e,_run(e,t){return"number"!=typeof e.value||isNaN(e.value)?P(this,"type",e,t):e.typed=!0,e}}}function S(e,t){return{kind:"schema",type:"object",reference:S,expects:"Object",async:!1,entries:e,message:t,_run(e,t){const r=e.value;if(r&&"object"==typeof r){e.typed=!0,e.value={};for(const i in this.entries){const n=r[i],f=this.entries[i]._run({typed:!1,value:n},t);if(f.issues){const a={type:"object",origin:"value",input:r,key:i,value:n};for(const t of f.issues)t.path?t.path.unshift(a):t.path=[a],e.issues?.push(t);if(e.issues||(e.issues=f.issues),t.abortEarly){e.typed=!1;break}}f.typed||(e.typed=!1),(void 0!==f.value||i in r)&&(e.value[i]=f.value)}}else P(this,"type",e,t);return e}}}function O(e,t,r){const i=e._run({typed:!1,value:t},function(e){return{lang:void 0,message:e?.message,abortEarly:void 0,abortPipeEarly:void 0}}(r));if(i.issues)throw new x(i.issues);return i.value}function U(...e){return{...e[0],pipe:e,_run(t,r){for(const i of e)if("metadata"!==i.kind){if(t.issues&&("schema"===i.kind||"transformation"===i.kind)){t.typed=!1;break}t.issues&&(r.abortEarly||r.abortPipeEarly)||(t=i._run(t,r))}return t}}}const D=U(H(),K(),I(0),A(4294967295)),B=U(H(),K(),I(0),A(2147483647)),F=U(H(),K(),I(0),A(255)),L=U(N(Uint8Array),T(32)),R=U(N(Uint8Array),T(33)),$=S({wif:F,bip32:S({public:D,private:D})}),q=U(function e(t){return{kind:"schema",type:"string",reference:e,expects:"string",async:!1,message:t,_run(e,t){return"string"==typeof e.value?e.typed=!0:P(this,"type",e,t),e}}}(),function e(t,r){return{kind:"validation",type:"regex",reference:e,async:!1,expects:`${t}`,requirement:t,message:r,_run(e,t){return e.typed&&!this.requirement.test(e.value)&&P(this,"format",e,t),e}}}(/^(m\/)?(\d+'?\/)*\d+'?$/));function j(e){return o.encode(function(e,t){if(32!==t.length)throw new TypeError("Invalid privateKey length");var r=new Uint8Array(34);return new DataView(r.buffer).setUint8(0,e),r.set(t,1),r[33]=1,r}(e.version,e.privateKey))}const C=d(s),M=e=>C.encode(e),Q=e=>C.decode(e);function J(e){!function(e){if(_(e.isPoint(E("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),_(!e.isPoint(E("030000000000000000000000000000000000000000000000000000000000000005"))),_(e.isPrivate(E("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),_(e.isPrivate(E("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),_(!e.isPrivate(E("0000000000000000000000000000000000000000000000000000000000000000"))),_(!e.isPrivate(E("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),_(!e.isPrivate(E("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),_(0===v(e.pointFromScalar(E("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af")),E("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),e.xOnlyPointAddTweak){_(null===e.xOnlyPointAddTweak(E("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),E("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140")));let t=e.xOnlyPointAddTweak(E("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),E("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));_(0===v(t.xOnlyPubkey,E("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&1===t.parity),t=e.xOnlyPointAddTweak(E("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),E("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47"))}_(0===v(e.pointAddScalar(E("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),E("0000000000000000000000000000000000000000000000000000000000000003")),E("02c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5"))),_(0===v(e.privateAdd(E("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),E("0000000000000000000000000000000000000000000000000000000000000002")),E("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),e.privateNegate&&(_(0===v(e.privateNegate(E("0000000000000000000000000000000000000000000000000000000000000001")),E("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),_(0===v(e.privateNegate(E("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e")),E("0000000000000000000000000000000000000000000000000000000000000003"))),_(0===v(e.privateNegate(E("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af")),E("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792")))),_(0===v(e.sign(E("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),E("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140")),E("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),_(e.verify(E("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),E("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),E("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),e.signSchnorr&&_(0===v(e.signSchnorr(E("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),E("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),E("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906")),E("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),e.verifySchnorr&&_(e.verifySchnorr(E("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),E("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),E("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}(e);const t={messagePrefix:"Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},r=2147483648;class i{__D;__Q;lowR=!1;constructor(e,t){this.__D=e,this.__Q=t}get publicKey(){return void 0===this.__Q&&(this.__Q=e.pointFromScalar(this.__D,!0)),this.__Q}get privateKey(){return this.__D}sign(t,r){if(!this.privateKey)throw new Error("Missing private key");if(void 0===r&&(r=this.lowR),!1===r)return e.sign(t,this.privateKey);{let r=e.sign(t,this.privateKey);const i=new Uint8Array(32);let n=0;for(;r[0]>127;)n++,w(i,0,n,"LE"),r=e.sign(t,this.privateKey,i);return r}}signSchnorr(t){if(!this.privateKey)throw new Error("Missing private key");if(!e.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return e.signSchnorr(t,this.privateKey)}verify(t,r){return e.verify(t,this.publicKey,r)}verifySchnorr(t,r){if(!e.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return e.verifySchnorr(t,this.publicKey.subarray(1,33),r)}}class n extends i{chainCode;network;__DEPTH;__INDEX;__PARENT_FINGERPRINT;constructor(e,t,r,i,n=0,f=0,a=0){super(e,t),this.chainCode=r,this.network=i,this.__DEPTH=n,this.__INDEX=f,this.__PARENT_FINGERPRINT=a,O($,i)}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get identifier(){return e=this.publicKey,a(s(e));var e}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return void 0===this.__D}neutered(){return o(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){const e=this.network,t=this.isNeutered()?e.bip32.public:e.bip32.private,r=new Uint8Array(78);return w(r,0,t,"BE"),g(r,4,this.depth),w(r,5,this.parentFingerprint,"BE"),w(r,9,this.index,"BE"),r.set(this.chainCode,13),this.isNeutered()?r.set(this.publicKey,45):(g(r,45,0),r.set(this.privateKey,46)),M(r)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return j({version:this.network.wif,privateKey:this.privateKey})}derive(t){O(D,t);const i=t>=r,n=new Uint8Array(37);if(i){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");n[0]=0,n.set(this.privateKey,1),w(n,33,t,"BE")}else n.set(this.publicKey,0),w(n,33,t,"BE");const f=h(this.chainCode,n),a=f.slice(0,32),s=f.slice(32);if(!e.isPrivate(a))return this.derive(t+1);let d;if(this.isNeutered()){const r=e.pointAddScalar(this.publicKey,a,!0);if(null===r)return this.derive(t+1);d=o(r,s,this.network,this.depth+1,t,m(this.fingerprint,0,"BE"))}else{const r=e.privateAdd(this.privateKey,a);if(null==r)return this.derive(t+1);d=c(r,s,this.network,this.depth+1,t,m(this.fingerprint,0,"BE"))}return d}deriveHardened(e){if("number"==typeof O(B,e))return this.derive(e+r);throw new TypeError("Expected UInt31, got "+e)}derivePath(e){O(q,e);let t=e.split("/");if("m"===t[0]){if(this.parentFingerprint)throw new TypeError("Expected master, got child");t=t.slice(1)}return t.reduce((e,t)=>{let r;return"'"===t.slice(-1)?(r=parseInt(t.slice(0,-1),10),e.deriveHardened(r)):(r=parseInt(t,10),e.derive(r))},this)}tweak(e){return this.privateKey?this.tweakFromPrivateKey(e):this.tweakFromPublicKey(e)}tweakFromPublicKey(t){const r=32===(n=this.publicKey).length?n:n.slice(1,33);var n;if(!e.xOnlyPointAddTweak)throw new Error("xOnlyPointAddTweak not supported by ecc library");const f=e.xOnlyPointAddTweak(r,t);if(!f||null===f.xOnlyPubkey)throw new Error("Cannot tweak public key!");const a=function(e){const t=e.reduce((e,t)=>e+t.length,0),r=new Uint8Array(t);let i=0;for(const n of e)r.set(n,i),i+=n.length;return r}([Uint8Array.from([0===f.parity?2:3]),f.xOnlyPubkey]);return new i(void 0,a)}tweakFromPrivateKey(t){const r=3===this.publicKey[0]||4===this.publicKey[0]&&!(1&~this.publicKey[64]),n=(()=>{if(r){if(e.privateNegate)return e.privateNegate(this.privateKey);throw new Error("privateNegate not supported by ecc library")}return this.privateKey})(),f=e.privateAdd(n,t);if(!f)throw new Error("Invalid tweaked private key!");return new i(f,void 0)}}function f(e,t,r){return c(e,t,r)}function c(r,i,f,a,s,c){if(O(L,r),O(L,i),f=f||t,!e.isPrivate(r))throw new TypeError("Private key not in range [1, n)");return new n(r,void 0,i,f,a,s,c)}function o(r,i,f,a,s,c){if(O(R,r),O(L,i),f=f||t,!e.isPoint(r))throw new TypeError("Point is not on the curve");return new n(void 0,r,i,f,a,s,c)}return{fromSeed:function(e,r){if(O(N(Uint8Array),e),e.length<16)throw new TypeError("Seed should be at least 128 bits");if(e.length>64)throw new TypeError("Seed should be at most 512 bits");r=r||t;const i=h((n="Bitcoin seed",y.encode(n)),e);var n;return f(i.slice(0,32),i.slice(32),r)},fromBase58:function(e,r){const i=Q(e);if(78!==i.length)throw new TypeError("Invalid buffer length");r=r||t;const n=m(i,0,"BE");if(n!==r.bip32.private&&n!==r.bip32.public)throw new TypeError("Invalid network version");const f=i[4],a=m(i,5,"BE");if(0===f&&0!==a)throw new TypeError("Invalid parent fingerprint");const s=m(i,9,"BE");if(0===f&&0!==s)throw new TypeError("Invalid index");const d=i.slice(13,45);let u;if(n===r.bip32.private){if(0!==i[45])throw new TypeError("Invalid private key");u=c(i.slice(46,78),d,r,f,s,a)}else{u=o(i.slice(45,78),d,r,f,s,a)}return u},fromPublicKey:function(e,t,r){return o(e,t,r)},fromPrivateKey:f}}export{J as BIP32Factory,J as default};
